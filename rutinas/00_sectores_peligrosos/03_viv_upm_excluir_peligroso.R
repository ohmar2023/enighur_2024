
machala_peligroso <- c("070150001001",
                       "070150001701",
                       "070150002401",
                       "070150005601",
                       "070150016201",
                       "070150016401",
                       "070150022201",
                       "070150032201",
                       "070150044001",
                       "070150044201",
                       "070150045501",
                       "070150045601",
                       "070150046401",
                       "070150071101",
                       "070150071201",
                       "070150071601",
                       "070150078401",
                       "070150085401",
                       "070150089401")

machala_zonas <- c("070150002",
                   "070150003",
                   "070150004",
                   "070150005",
                   "070150006",
                   "070150007",
                   "070150008",
                   "070150009",
                   "070150015",
                   "070150016",
                   "070150017",
                   "070150064",
                   "070150066")


morona_costosos <- c("140950999003",
                     "140950999004",
                     "140950999005",
                     "140950999006",
                     "140950999007",
                     "140950999008",
                     "140950999009",
                     "140950999010",
                     "140950999012",
                     "140950999013",
                     "140951999001",
                     "140951999002",
                     "140951999003",
                     "140951999004",
                     "140951999005",
                     "140951999006",
                     "140951999007",
                     "140951999008",
                     "140951999009",
                     "140951999010",
                     "140951999011",
                     "140952999002",
                     "140952999003",
                     "140952999004",
                     "140952999005",
                     "140952999006",
                     "140952999007",
                     "140952999008",
                     "140952999009",
                     "140952999010",
                     "140952999011",
                     "140952999012",
                     "140952999013",
                     "140952999014",
                     "140952999015",
                     "140952999016",
                     "140952999017",
                     "140952999018",
                     "140952999019",
                     "140952999020",
                     "140952999021",
                     "140952999022",
                     "140952999023",
                     "140953999025",
                     "140953999027",
                     "140953999028",
                     "140953999030",
                     "140953999031",
                     "140953999032",
                     "140953999033",
                     "140954001001",
                     "140954999001",
                     "140954999002",
                     "140954999003",
                     "140954999004",
                     "140954999005",
                     "140954999006",
                     "140954999007",
                     "140954999008",
                     "140954999009",
                     "140954999010",
                     "140954999011",
                     "140954999012",
                     "140954999013",
                     "140954999014",
                     "140954999015",
                     "140954999016",
                     "140954999017",
                     "140954999018",
                     "140954999019",
                     "140954999020",
                     "140954999021",
                     "140954999022",
                     "140954999023",
                     
                     "140950900101",
                     "140951900201",
                     "140951900401",
                     "140952900101",
                     "140953900801",
                     "140953901301",
                     "140954900601")

pastaza_costosos <- c("160162999023",
                      "220159999002",
                      "220159999003")

pastaza_costosos_parr <- c("160156",
                           "160158",
                           "160159",
                           "160161",
                           "160451")

orellana_costosos <- c("2201599001")

#2201599001
# c("220159999002",
#   "220159999003")

marco_upm %>% 
  mutate(zonas = substr(id_upm,1,9),
         parr = substr(id_upm,1,6),
         congl = substr(id_upm,1,10)) %>% 
  group_by(pro) %>% 
  mutate(total_viv = sum(Mi),
         total_upm = n_distinct(id_upm)) %>% 
  ungroup() %>% 
  filter(id_upm %in% machala_peligroso | 
           zonas %in% machala_zonas |
           id_upm %in%  morona_costosos |
           parr %in% pastaza_costosos_parr |
           id_upm %in% pastaza_costosos |
           id_upm %in% orellana_costosos |
           congl %in% orellana_costosos
         ) %>% 
  group_by(pro) %>% 
  summarise(
    total_viv = unique(total_viv),
    viv_excluir = sum(Mi),
    prom_viv_excluir = sum(Mi)*100/unique(total_viv),
    total_upm = unique(total_upm),
    upm_excluir = n_distinct(id_upm),
    prom_upm_excluir = n_distinct(id_upm)*100/(total_upm)) %>% 
  View()

# ----------------------------------------------------------------------------

aux <- marco_upm %>% 
  mutate( can = substr(id_upm,1,4)) %>% 
  filter(pro == "13") 

table(aux$can,aux$estrato)

















